"use strict";(self.webpackChunkpd_pro_angularcli=self.webpackChunkpd_pro_angularcli||[]).push([[487],{42487:function(w,y,i){i.r(y),i.d(y,{ReunionModule:function(){return F}});var g=i(43144),R=i(15671),b=i(69808),S=i(35226),u=i.n(S),x=i(11796),l=i(91891),D=i(40520),E=i(70262),B=i(62843),Y=i(18505),T=i(7107),U=function(){var r=function(){function s(t,e){(0,R.Z)(this,s),this.http=t,this.token=e}return(0,g.Z)(s,[{key:"createReunion",value:function(e){var n=new D.WM({"Content-Type":"application/json",Authorization:"Bearer "+this.token.get()});return console.log(e),this.http.post("http://localhost:8000/api/reunion",e,{headers:n})}},{key:"updateReunion",value:function(e,n){return this.http.put("http://localhost:8000/api/reunions/".concat(e),n)}},{key:"deleteReunion",value:function(e){return this.http.delete("http://localhost:8000/api/reunions/".concat(e)).pipe((0,E.K)(function(n){return 404===n.status&&console.error("R\xe9union avec l'ID ".concat(e," non trouv\xe9e.")),(0,B._)("Erreur lors de la suppression de la r\xe9union.")}))}},{key:"getReunions",value:function(){return this.http.get("http://localhost:8000/api/reunions").pipe((0,Y.b)(function(e){return console.log("R\xe9unions r\xe9cup\xe9r\xe9es:",e)}),(0,E.K)(function(e){return console.error("Erreur lors de la r\xe9cup\xe9ration des r\xe9unions:",e),(0,B._)(e)}))}},{key:"getInvitedUsers",value:function(e,n){return this.http.get("http://localhost:8000/api/companies/".concat(e,"/reunions/").concat(n,"/invited-users"))}},{key:"inviteUsers",value:function(e,n){return this.http.post("http://localhost:8000/api/reunions/invite-users",{reunion_id:e,user_id:n})}}]),s}();return r.\u0275fac=function(t){return new(t||r)(l.LFG(D.eN),l.LFG(T.B))},r.\u0275prov=l.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r}(),z=i(45892),M=i(52297),k=[{path:"",children:[{path:"",component:function(){var r=function(){function s(t,e,n){(0,R.Z)(this,s),this.reunionService=t,this.participantService=e,this.router=n}return(0,g.Z)(s,[{key:"ngOnInit",value:function(){this.loadReunions(),this.loadUsers(),this.initializeCalendar()}},{key:"loadReunions",value:function(){var e=this;this.reunionService.getReunions().subscribe(function(n){e.reunions=n.reunions,e.renderCalendarEvents()},function(n){console.error("Erreur lors de la r\xe9cup\xe9ration des r\xe9unions",n)})}},{key:"loadUsers",value:function(){var e=this;this.participantService.getUsersByAdminCompanyId().subscribe(function(n){e.users=n},function(n){console.error("Erreur lors de la r\xe9cup\xe9ration des utilisateurs",n)})}},{key:"initializeCalendar",value:function(){var e=this,n=$("#fullCalendar"),d=this;n.fullCalendar({viewRender:function(o,v){if("month"!==o.name){var c=$(v).find(".fc-scroller")[0];new x.Z(c)}},header:{left:"title",center:"month,agendaWeek,agendaDay",right:"prev,next,today"},selectable:!0,selectHelper:!0,views:{month:{titleFormat:"MMMM YYYY"},week:{titleFormat:"MMMM D YYYY"},day:{titleFormat:"D MMM, YYYY"}},select:function(o){d.createReunionDialog(o)},eventClick:function(o,v,c){e.updateOrDeleteReunionDialog(o)},editable:!0,eventLimit:!0})}},{key:"renderCalendarEvents",value:function(){var e=this.reunions.map(function(n){return{id:n.id,title:n.titre,start:n.date,description:n.description}});$("#fullCalendar").fullCalendar("renderEvents",e,!0)}},{key:"createReunionDialog",value:function(e){var n=this,d=this.users.map(function(a){return'<option value="'.concat(a.id,'">').concat(a.nom," ").concat(a.prenom,"</option>")}).join("");u().fire({title:"Cr\xe9er une r\xe9union",html:'\n        <div class="form-group">\n          <input class="form-control" placeholder="Titre" id="event-title">\n        </div>\n        <div class="form-group">\n          <textarea class="form-control" placeholder="Description" id="event-description"></textarea>\n        </div>\n        <div class="form-group">\n          <label for="participants-select">S\xe9lectionnez les participants:</label>\n          <select class="form-control" id="participants-select" multiple>\n            '.concat(d,'\n          </select>\n        </div>\n        <div class="form-group">\n          <label for="event-start">Date et heure de d\xe9but:</label>\n          <input type="text" class="form-control" id="event-start" value="').concat(e,'">\n        </div>\n      \n      '),showCancelButton:!0,confirmButtonText:"Cr\xe9er",cancelButtonText:"Annuler",customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1,preConfirm:function(){var o=$("#event-title").val(),v=$("#event-description").val(),c=$("#participants-select").val(),p=$("#event-start").val();return console.log(c),o&&c.length?{title:o,description:v,participantIds:c,startDate:p}:(u().showValidationMessage("Le titre et au moins un participant sont requis."),!1)}}).then(function(a){if(a.isConfirmed&&a.value){var o=a.value;n.reunionService.createReunion({titre:o.title,description:o.description,date:o.startDate,participants:o.participantIds}).subscribe(function(m){console.log(m),n.loadReunions(),u().fire("Succ\xe8s","R\xe9union cr\xe9\xe9e avec succ\xe8s","success")},function(m){console.error("Erreur lors de la cr\xe9ation de la r\xe9union",m),u().fire("Erreur","Une erreur est survenue lors de la cr\xe9ation de la r\xe9union. Veuillez r\xe9essayer.","error")})}})}},{key:"updateOrDeleteReunionDialog",value:function(e){var n=this,d=e.id,a=e.title,o=e.description,v=e.start;u().fire({title:"D\xe9tails de la r\xe9union",html:"<p><strong>Titre:</strong> ".concat(a,"</p><p><strong>Description:</strong> ").concat(o,"</p>"),showCloseButton:!0,showCancelButton:!0,showConfirmButton:!0,cancelButtonText:"Supprimer",cancelButtonColor:"#d33",confirmButtonText:"Modifier",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-danger"},buttonsStyling:!1}).then(function(c){c.isConfirmed?u().fire({title:"Modifier la r\xe9union",html:'\n            <div class="form-group">\n              <input class="form-control" placeholder="Titre" id="updated-event-title" value="'.concat(a,'">\n            </div>\n            <div class="form-group">\n              <textarea class="form-control" placeholder="Description" id="updated-event-description">').concat(o,"</textarea>\n            </div>\n          "),showCancelButton:!0,confirmButtonText:"Enregistrer",cancelButtonText:"Annuler",customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1,preConfirm:function(){var f=$("#updated-event-title").val(),h=$("#updated-event-description").val();return f||u().showValidationMessage("Le titre est requis."),{updatedTitle:f,updatedDescription:h}}}).then(function(p){if(p.isConfirmed){var f=p.value,h=f.updatedTitle;n.reunionService.updateReunion(d,{id:d,titre:h,description:f.updatedDescription,date:v}).subscribe(function(){n.loadReunions();var C=$("#fullCalendar").fullCalendar("clientEvents",d)[0];C&&(C.title=h,$("#fullCalendar").fullCalendar("updateEvent",C)),u().fire("Succ\xe8s","R\xe9union mise \xe0 jour avec succ\xe8s","success")},function(C){console.error("Erreur lors de la mise \xe0 jour de la r\xe9union",C),u().fire("Erreur","Une erreur est survenue lors de la mise \xe0 jour de la r\xe9union. Veuillez r\xe9essayer.","error")})}}):c.dismiss===u().DismissReason.cancel&&(d?n.reunionService.deleteReunion(d).subscribe(function(){$("#fullCalendar").fullCalendar("removeEvents",d),u().fire("Succ\xe8s","R\xe9union supprim\xe9e avec succ\xe8s","success")},function(p){console.error("Erreur lors de la suppression de la r\xe9union",p),u().fire("Erreur","Une erreur est survenue lors de la suppression de la r\xe9union. Veuillez r\xe9essayer.","error")}):console.error("L'ID de la r\xe9union est ind\xe9fini"))})}}]),s}();return r.\u0275fac=function(t){return new(t||r)(l.Y36(U),l.Y36(z.E),l.Y36(M.F0))},r.\u0275cmp=l.Xpm({type:r,selectors:[["app-reunion"]],decls:7,vars:0,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-10","col-md-offset-1"],[1,"card","card-calendar"],[1,"card-content"],["id","fullCalendar"]],template:function(t,e){1&t&&(l.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),l._UZ(6,"div",6),l.qZA()()()()()())},styles:[""]}),r}()}]}],Z=i(93075),F=function(){var r=(0,g.Z)(function s(){(0,R.Z)(this,s)});return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=l.oAB({type:r}),r.\u0275inj=l.cJS({imports:[[b.ez,M.Bz.forChild(k),Z.u5]]}),r}()}}]);