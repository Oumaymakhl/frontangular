"use strict";(self.webpackChunkpd_pro_angularcli=self.webpackChunkpd_pro_angularcli||[]).push([[659],{67659:function(B,f,a){a.r(f),a.d(f,{TaskModule:function(){return M}});var g=a(43144),T=a(15671),m=a(69808),p=a(93075),b=a(52297),k=a(35226),l=a.n(k),C=a(4128),t=a(91891),Z=a(999),y=a(45892);function x(s,i){if(1&s&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td",16)(12,"button",17),t._UZ(13,"i",18),t.qZA(),t.TgZ(14,"button",19),t._UZ(15,"i",20),t.qZA()()()),2&s){var n=i.$implicit;t.xp6(2),t.Oqu(n.userName),t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.description),t.xp6(2),t.Oqu(n.estimated_time),t.xp6(2),t.Oqu(n.status)}}function A(s,i){1&s&&(t.TgZ(0,"tr")(1,"td",21),t._uU(2,"No tasks found"),t.qZA()())}var U=[{path:"",children:[{path:"task",component:function(){var s=function(){function i(n,e){(0,T.Z)(this,i),this.taskService=n,this.participantService=e,this.tasks=[],this.users=[],this.searchTerm=""}return(0,g.Z)(i,[{key:"ngOnInit",value:function(){this.loadTasks(),this.loadUsers()}},{key:"loadTasks",value:function(){var e=this;this.taskService.getTasks().subscribe(function(o){e.tasks=o.tasks;var c=e.tasks.map(function(r){return e.participantService.getUserNameById(r.user_id)});(0,C.D)(c).subscribe(function(r){e.tasks.forEach(function(u,d){u.userName=r[d]})},function(r){console.error("Error fetching user names:",r)})},function(o){console.error("Error loading tasks:",o)})}},{key:"loadUsers",value:function(){var e=this;this.taskService.getUsersByAdminCompanyId().subscribe(function(o){console.log("Users loaded:",o),e.users=o},function(o){console.error("Error loading users:",o)})}},{key:"ajouterTache",value:function(){var e=this;if(console.log("Current users:",this.users),Array.isArray(this.users)&&0!==this.users.length){var o=this.users.map(function(c){return'<option value="'.concat(c.id,'">').concat(c.nom," ").concat(c.prenom,"</option>")}).join("");console.log("User options:",o),l().fire({title:"Ajouter une t\xe2che",html:'\n                    <input type="text" id="nomTache" class="swal2-input" placeholder="Nom de la t\xe2che">\n                    <textarea id="descriptionTache" class="swal2-textarea" placeholder="Description"></textarea>\n                    <input type="number" id="tempsEstime" class="swal2-input" placeholder="Temps estim\xe9 (en heures)">\n                    <select id="participantSelect" class="swal2-select">\n                        <option value="" disabled selected>Choisissez un participant</option>\n                        '.concat(o," \x3c!-- Utiliser la liste des utilisateurs ici --\x3e\n                    </select>\n                "),showCancelButton:!0,confirmButtonText:"Ajouter",cancelButtonText:"Annuler",preConfirm:function(){var r=document.getElementById("nomTache").value,u=document.getElementById("descriptionTache").value,d=parseFloat(document.getElementById("tempsEstime").value),v=parseInt(document.getElementById("participantSelect").value,10);if(!r||!u||isNaN(d)||isNaN(v))return l().showValidationMessage("Tous les champs sont obligatoires."),!1;e.taskService.addTask({id:0,user_id:v,status:"todo",estimated_time:d,name:r,description:u}).subscribe(function(h){e.tasks.push(h),l().fire("Succ\xe8s","La t\xe2che a \xe9t\xe9 ajout\xe9e avec succ\xe8s.","success")},function(h){console.error("Error adding task:",h),l().fire("Erreur","Une erreur s'est produite lors de l'ajout de la t\xe2che.","error")})}})}else console.error("No users available:",this.users)}},{key:"editerTache",value:function(e){var o=this;l().fire({title:"Modifier la t\xe2che",html:'\n                <input type="text" id="nomTache" class="swal2-input" placeholder="Nom de la t\xe2che" value="'.concat(e.name,'">\n                <textarea id="descriptionTache" class="swal2-textarea" placeholder="Description">').concat(e.description,'</textarea>\n                <input type="number" id="tempsEstime" class="swal2-input" placeholder="Temps estim\xe9 (en heures)" value="').concat(e.estimated_time,'">\n            '),showCancelButton:!0,confirmButtonText:"Enregistrer",cancelButtonText:"Annuler",preConfirm:function(){var r=document.getElementById("nomTache").value,u=document.getElementById("descriptionTache").value,d=parseFloat(document.getElementById("tempsEstime").value);if(!r||!u||isNaN(d))return l().showValidationMessage("Tous les champs sont obligatoires."),!1;e.name=r,e.description=u,e.estimated_time=d,o.taskService.updateTask(e.id,e).subscribe(function(){})}})}},{key:"supprimerTache",value:function(e){var o=this;l().fire({title:"\xcates-vous s\xfbr?",text:"Vous ne pourrez pas revenir en arri\xe8re!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Oui, supprimez-le!"}).then(function(c){c.isConfirmed&&o.taskService.deleteTask(e).subscribe(function(){o.tasks=o.tasks.filter(function(r){return r.id!==e})})})}},{key:"filteredTasks",value:function(){var e=this;return this.tasks.filter(function(o){return o.name.toLowerCase().includes(e.searchTerm.toLowerCase())})}}]),i}();return s.\u0275fac=function(n){return new(n||s)(t.Y36(Z.M),t.Y36(y.E))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-task"]],decls:37,vars:3,consts:[[1,"container-xl","mt-5","mb-4"],[1,"table-responsive"],[1,"table-wrapper","mt-5"],[1,"table","table-bordered","shadow","rounded"],["colspan","7"],[1,"table-title","bg-custom-blue","text-light","p-4","rounded-top","d-flex","justify-content-between","align-items-center"],[1,"m-0"],[1,"d-flex","align-items-center"],["type","text","placeholder","Search by title",1,"form-control","w-50","mr-2",3,"ngModel","ngModelChange"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-plus-circle"],[1,"ml-2"],[1,"table","table-striped","table-hover"],[1,"bg-white","text-dark"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"td-actions","text-right"],["type","button","title","Edit Task",1,"btn","btn-warning","btn-icon","btn-sm","mr-2"],[1,"fa","fa-edit"],["type","button","title","Remove",1,"btn","btn-danger","btn-icon","btn-sm"],[1,"fa","fa-times"],["colspan","7",1,"text-center"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"table",3)(4,"tbody")(5,"tr")(6,"td",4)(7,"div",5)(8,"h4",6)(9,"b"),t._uU(10,"Tasks"),t.qZA()(),t.TgZ(11,"div",7)(12,"input",8),t.NdJ("ngModelChange",function(c){return e.searchTerm=c}),t.qZA(),t.TgZ(13,"button",9),t.NdJ("click",function(){return e.ajouterTache()}),t._UZ(14,"i",10),t.TgZ(15,"span",11),t._uU(16,"Add Task"),t.qZA()()()()()(),t.TgZ(17,"tr")(18,"td")(19,"table",12)(20,"thead",13)(21,"tr")(22,"th"),t._uU(23,"User Name"),t.qZA(),t.TgZ(24,"th"),t._uU(25,"Task Name"),t.qZA(),t.TgZ(26,"th"),t._uU(27,"Description"),t.qZA(),t.TgZ(28,"th"),t._uU(29,"Estimated Time (hours)"),t.qZA(),t.TgZ(30,"th"),t._uU(31,"Status"),t.qZA(),t.TgZ(32,"th"),t._uU(33,"Actions"),t.qZA()()(),t.TgZ(34,"tbody"),t.YNc(35,x,16,5,"tr",14),t.YNc(36,A,3,0,"tr",15),t.qZA()()()()()()()()()),2&n&&(t.xp6(12),t.Q6J("ngModel",e.searchTerm),t.xp6(23),t.Q6J("ngForOf",e.tasks),t.xp6(1),t.Q6J("ngIf",0==e.tasks.length))},directives:[p.Fj,p.JJ,p.On,m.sg,m.O5],styles:[".bg-custom-blue[_ngcontent-%COMP%]{background-color:#036;color:#fff}.table-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;border-radius:3px;cursor:pointer}.table-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#218838}.table-striped[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-of-type(odd){background-color:#f8f9fa}.btn-warning[_ngcontent-%COMP%]{background-color:#ffc107!important;color:#212529!important}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#e0a800!important}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545!important;color:#fff!important}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333!important}"]}),s}()}]}],M=function(){var s=(0,g.Z)(function i(){(0,T.Z)(this,i)});return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[m.ez,b.Bz.forChild(U),p.u5]]}),s}()}}]);